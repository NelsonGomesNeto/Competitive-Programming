This was NICE. Imagining the beans and timelines was a ride.

I solved with an O(n*m) DP.